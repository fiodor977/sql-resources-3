--Cursor que creas cuando una consulta devuelve más de un dato

-- Recorre todas las filas de la tabla artículo y devuelve ciertas columnas. Un ejemplo por tipo de bucle.

--Usando loop
DECLARE
  -- Declara un cursor que tiene más de un registro de resultados
  CURSOR C1 IS
  SELECT * FROM ARTICULO;

  // Declara un fila de la tabla ARTICULO
  ART ARTICULO%ROWTYPE;

BEGIN
  OPEN C1;
    LOOP
      -- Obtiene una fila del registro y la mete en ART
        FETCH C1 INTO ART;
        
        -- Sale del bucle cuando no hay más resultados
        EXIT WHEN C1%NOTFOUND;
          DBMS_OUTPUT.PUT_LINE(ART.CATEGORIA || ' ' || ART.REFERENCIA);

    END LOOP;
  CLOSE C1;
END;

--Usando for
DECLARE
  CURSOR C1 IS
  SELECT * FROM ARTICULO;

  ART ARTICULO%ROWTYPE;

BEGIN

FOR ART IN C1 LOOP

        DBMS_OUTPUT.PUT_LINE(ART.CATEGORIA || ' ' || ART.REFERENCIA);

END LOOP;

END;

--Usando while
DECLARE
  CURSOR C1 IS
  SELECT * FROM ARTICULO;

ART ARTICULO%ROWTYPE;

BEGIN
OPEN C1;
  -- Obtiene una fila del resultado del cursor
  FETCH C1 INTO ART;
  -- Se ejecuta el bucle mientras haya resultados
  WHILE C1%FOUND LOOP
        DBMS_OUTPUT.PUT_LINE(ART.CATEGORIA || ' ' || ART.REFERENCIA);
        -- Obtiene el siguiente registro para la siguiente iteracción del bucle
        FETCH C1 INTO ART;
  END LOOP;
CLOSE C1;
END;
